-- favorites 테이블 생성
create table favorites (
-- 자동 증가하는 고유 ID (primary key)
id bigint generated by default as identity primary key,

-- 사용자 ID (auth.users 테이블의 외래키)
user_id uuid references auth.users(id) on delete cascade,

-- 영화 ID (movie 테이블의 외래키)
movie_id bigint references movie(id) on delete cascade,

-- 생성 시간 (UTC 기준, 자동 설정)
created_at timestamp with time zone default timezone('utc'::text, now()) not null,

-- 사용자-영화 조합의 유일성 보장
unique(user_id, movie_id)
);

-- 성능 최적화를 위한 인덱스 생성
create index favorites_user_id_idx on favorites(user_id);
create index favorites_movie_id_idx on favorites(movie_id);
